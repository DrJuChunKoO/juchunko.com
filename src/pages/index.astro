---
import Layout from "../layouts/Layout.astro";
import ThemeToggle from "@/components/ThemeToggle.astro";
import BaseHead from "@/components/BaseHead.astro";
import { ArrowRight } from "@lucide/astro";
import { getLangFromUrl, useTranslations } from "src/i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<Layout>
	<BaseHead slot="head" description={t("home.description")} />
	<div
		class="mx-auto flex h-20 max-w-360 items-center justify-end gap-2 pr-[max(env(safe-area-inset-right),2rem)] pl-[max(env(safe-area-inset-left),2rem)] text-sm md:max-w-[90vw]"
	>
		<a class="flex items-center text-base hover:opacity-75 ltr:mr-auto rtl:ml-auto" href="/">
			<span class="font-medium uppercase" data-lang="sitename">科技立委葛如鈞．寶博士</span>
		</a>
		<ThemeToggle />
	</div>
	<div class="relative mx-auto aspect-square w-full max-w-3xl sm:aspect-video xl:mt-20">
		<script type="module" src="https://unpkg.com/@splinetool/viewer@1.0.18/build/spline-viewer.js"></script>
		<spline-viewer
			className="absolute inset-0"
			loading-anim-type="spinner-big-light"
			url="https://prod.spline.design/PykwbOV-m1ak0rZ0/scene.splinecode"></spline-viewer>

		<div class="absolute inset-0 flex flex-col items-center justify-center gap-2">
			<div class="text-center text-xl font-semibold tracking-wide uppercase sm:text-3xl lg:text-4xl">The Plurality is here.</div>
			<p class="text-xl font-medium md:text-2xl" data-lang="title">先進國會・共識未來</p>
		</div>
	</div>
	<div class="flex flex-col items-center justify-center gap-4 text-center">
		<a
			href="/zh-TW"
			class="bg-muted text-muted-foreground hover:bg-muted-foreground/10 active:bg-muted-foreground/20 group hover:outline-primary/50 flex w-max items-center justify-center gap-2 rounded-full px-5 py-2 tracking-tight hover:outline-2 hover:outline-offset-2"
			data-lang="button"
		>
			<span data-lang="buttonText"> 進入「科技立委葛如鈞．寶博士」宇宙 </span>
			<ArrowRight class="size-5 animate-pulse transition-transform group-hover:translate-x-1" />
		</a>
	</div>
</Layout>
<script>
	const browserLang = navigator.language;
	const lang = browserLang.startsWith("zh") ? "zh-TW" : "en";
	const locale = {
		"zh-TW": {
			sitename: "科技立委葛如鈞．寶博士",
			title: "先進國會・共識未來",
			buttonText: `進入「科技立委葛如鈞．寶博士」宇宙`,
		},
		en: {
			sitename: "Ju Chun Ko",
			title: "Emerging Congress, Converging Consensus",
			buttonText: `Enter Dr.Ju-Chun KO Universe`,
		},
	};

	document.querySelector(`[data-lang="button"]`)?.setAttribute("href", `/${lang}`);
	document.querySelectorAll("[data-lang]").forEach((el) => {
		const key = el.getAttribute("data-lang");
		if (key && locale[lang][key]) {
			el.textContent = locale[lang][key];
		}
	});
</script>
